<!DOCTYPE html>
<html lang="en">
    {% load static %}
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
            <script src = "https://cdn.jsdelivr.net/npm/chart.js" ></script>
            <link rel="icon" type="image/x-icon" href="{% static 'images/sitelogo3.png' %}">
    <title>My Account</title>
</head>

<body style="background-color: #f8f9fa;">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="{% static 'images/sitelogo3.png' %}" alt="Company Logo" height="60">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                    </li>
                    <!-- Add other navigation items as needed -->
                </ul>
            </div>
        </div>
    </nav>

    <!-- Jumbotron with Random Avatar -->
    <div class="container mt-4">
        <div class="jumbotron text-center">
            <img src="https://avatar.iran.liara.run/public" alt="Random Avatar" height="250" width     ="250" class="rounded-circle">
            <h1 class="display-4">My Account</h1>
           
        </div>
    </div>

    <!-- Account Information -->
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Account Information</h5>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                </tr>
                            </thead>
                            <tbody id="userDataBody"></tbody>
                        </table>
                        <div class="row">
                            <div class="col md-6"><a href="http://127.0.0.1:8000/users/" class="btn btn-primary d-flex justify-content-between  align-items-center ">Back</a></div>
                            <div class="col md-6">
                                <button type="submit" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#addSellerModal" data-bs-toggle="modal"
                                    data-bs-target="#addSellerModal">
                                    Sell on Zlingo
                                </button>
        </div>
                        </div>
                        
                        
                    </div>
                    
                </div>
            </div>
        </div>
        
    </div>
    <div class="modal modal-xl fade text-dark" id="addSellerModal" tabindex="-1" role="dialog"
    aria-labelledby="addSellerModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title fs-1" id="addSellerModalLabel">Sell on Zlingo</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    
                </button>
            </div>
            <div class="modal-body">

                <!-- Seller Form -->
                <form id="sellerForm">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="seller_name">Seller Name:</label>
                        <input type="text" required pattern="[A-Za-z\s]+"
                            oninput="this.value = this.value.replace(/[^A-Za-z\s]/g, '')" class="form-control"
                            id="seller_name" value="Seller" name="seller_name" required>
                    </div>
                    <div class="form-group">
                        <label for="business_name">Business Name:</label>
                        <input type="text" value="SellerShop " required pattern="[A-Za-z\s]+"
                            oninput="this.value = this.value.replace(/[^A-Za-z\s]/g, '')" class="form-control"
                            id="business_name" name="business_name" required>
                    </div>
                    <div class="form-group">
                        <label for="gstin_number">GSTIN Number:</label>
                        <input type="text" value="GSTIN121235423" class="form-control" id="gstin_number" name="gstin_number" required>
                    </div>
                    <div class="form-group">
                        <label for="seller_shop_address">Shop Address:</label>
                        <input type="text" value="Adress some of the dat" class="form-control" id="seller_shop_address"
                            name="seller_shop_address" required>
                    </div>
                    <div class="form-group">
                        <label for="seller_email">Seller Email:</label>
                        <input type="checkbox" id="use_current_email">
                        <label for="use_current_email">Use current email</label>
                    
                        <input type="text" value="user@example.com" class="form-control" id="seller_email" name="seller_email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="seller_phone">Seller Phone:</label>
                        <input type="checkbox" id="use_current_phone" >
                        <label for="use_current_phone">Use current phone number</label>
                    
                        <input type="text"  required pattern="[0-9]+" maxlength="10"
                            oninput="this.value = this.value.replace(/[^0-9\d]/g, '')" class="form-control"
                            id="seller_phone" name="seller_phone" required>
                    </div>
                    <div class="form-group">
                        <label for="seller_password">Seller password:</label>
                        <input type="text" value="552498syher" required class="form-control"
                            id="seller_password" name="seller_password" required>
                    </div>


                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>

    <script>
        $(document).ready(function () {
            if ($('#use_current_email').prop('checked')) {
    console.log("hi");
}




            $('#sellerForm').submit(function (e) {
                        e.preventDefault();
                        seller_email=$('#seller_email').val()
                        var formData = 
                        {
                            "seller_name": $('#seller_name').val(),
                            "business_name": $('#business_name').val(),
                            "gstin_number": $('#gstin_number').val(),
                            "seller_shop_address": $('#seller_shop_address').val(),
                            "seller_email": $('#seller_email').val(),
                            "seller_phone": $('#seller_phone').val(),
                            "seller_password": $('#seller_password').val(),
                        }


                        console.log(JSON.stringify(formData));

                        $.ajax({
                            type: 'POST',
                            url: 'http://127.0.0.1:8000/admins/api-seller/',
                            data: JSON.stringify(formData),
                            contentType: "application/json",
                            success: function (data) {

                                $('#addSellerModal').modal('hide');
                                
                                alert('Seller added successfully!');
                            },
                            error: function (xhr, status, error) {

                                
                                alert(xhr.responseText);
                            }
                        });
                    });

            $.ajax({
                url: 'http://127.0.0.1:8000/users/customers/',
                method: 'GET',
                dataType: 'json',
                success: function (data) {
                   console.log("DATA",data);
                    $.each(data, function (index, user) {
                        $('#userDataBody').append('<tr>' +
                            '<td>' + user.user_name + '</td>' +
                            '<td id="user_email" value="' + user.user_email + '">' + user.user_email + '</td>' +

                            '<td>' + user.user_phone + '</td>' +
                            '</tr>');
                    });
                },
                error: function (error) {
                    alert('Error fetching user data:', error);
                }
            });
        });
    </script>

    
   
</body>

</html>
